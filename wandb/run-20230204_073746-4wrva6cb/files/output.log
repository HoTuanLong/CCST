Device: cuda:0
Building server's model...
Preparing data...
Prepare 1 ...
Prepare 2 ...
Source domain (for training) is ['1', '2']
Target domain (for testing) is ['0']
/home/ubuntu/miniconda3/envs/tensorflow/lib/python3.10/site-packages/torchvision/models/_utils.py:252: UserWarning: Accessing the model URLs via the internal dictionary of the module is deprecated since 0.13 and may be removed in the future. Please access them via the appropriate Weights Enum instead.
  warnings.warn(
Saving to /home/ubuntu/long.ht/CCST/utils/../logs/../checkpoint/pacs/fedavg_no_fusion_no_DG_resnet50_locIter1/Target_0_seed_1/iters500_bs64_lr0.001_class345_271
=============Global iter is 0 ===============
----------------Training----------------
== Train epoch 0 ===
 1          | Train Loss: 5.4976
 1          | Train Class Acc: 0.0100
 2          | Train Loss: 5.4841
 2          | Train Class Acc: 0.0100
----------------Validate global model on source domains----------------
 1          | Global Val Loss: 5.8985
 1          | Global Val Class Acc: 0.0044
 2          | Global Val Loss: 5.9200
 2          | Global Val Class Acc: 0.0029
-------------Test server model on target domain testset----------------
 0          | Global Test Loss: 5.9044
 0          | Global Test Class Acc: 0.0016
 Saving current best checkpoints to ../checkpoint/pacs/fedavg_no_fusion_no_DG_resnet50_locIter1/Target_0_seed_1/fedavg...
=============Global iter is 1 ===============
----------------Training----------------
== Train epoch 1 ===
 2          | Train Loss: 4.6117
 2          | Train Class Acc: 0.6900
 1          | Train Loss: 4.6241
 1          | Train Class Acc: 0.7600
----------------Validate global model on source domains----------------
Traceback (most recent call last):
  File "/home/ubuntu/long.ht/CCST/./federated/fed_run.py", line 731, in <module>
    val_loss, val_acc = test(server_model, val_loader, loss_fun, torch.device(f'cuda:1'), args)
  File "/home/ubuntu/long.ht/CCST/./federated/fed_run.py", line 243, in test
    for it, (data, class_l) in enumerate(test_loader):
  File "/home/ubuntu/miniconda3/envs/tensorflow/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/ubuntu/miniconda3/envs/tensorflow/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 671, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/ubuntu/miniconda3/envs/tensorflow/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/ubuntu/miniconda3/envs/tensorflow/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/ubuntu/long.ht/CCST/data/ImageLoader.py", line 85, in __getitem__
    return self._image_transformer(img), int(self.labels[index])
  File "/home/ubuntu/miniconda3/envs/tensorflow/lib/python3.10/site-packages/torchvision/transforms/transforms.py", line 95, in __call__
    img = t(img)
  File "/home/ubuntu/miniconda3/envs/tensorflow/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/ubuntu/miniconda3/envs/tensorflow/lib/python3.10/site-packages/torchvision/transforms/transforms.py", line 346, in forward
    return F.resize(img, self.size, self.interpolation, self.max_size, self.antialias)
  File "/home/ubuntu/miniconda3/envs/tensorflow/lib/python3.10/site-packages/torchvision/transforms/functional.py", line 474, in resize
    return F_pil.resize(img, size=output_size, interpolation=pil_interpolation)
  File "/home/ubuntu/miniconda3/envs/tensorflow/lib/python3.10/site-packages/torchvision/transforms/functional_pil.py", line 252, in resize
    return img.resize(tuple(size[::-1]), interpolation)
  File "/home/ubuntu/miniconda3/envs/tensorflow/lib/python3.10/site-packages/PIL/Image.py", line 2192, in resize
    return self._new(self.im.resize(size, resample, box))
KeyboardInterrupt